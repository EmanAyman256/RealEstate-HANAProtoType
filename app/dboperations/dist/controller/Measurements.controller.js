sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(e,t,o,s){"use strict";return e.extend("dboperations.controller.Measurements",{onInit:function(){this._loadMeasurements()},_loadMeasurements:function(){fetch("./odata/v4/real-estate/Measurements").then(e=>e.json()).then(e=>{this.getView().setModel(new s(e.value||[]),"measurements")}).catch(e=>console.error("Failed to load Measurements:",e))},onAddMeasurement:function(){this._openMeasurementDialog({})},onEditMeasurement:function(e){const t=e.getSource().getBindingContext("measurements");const o=t.getObject();this._openMeasurementDialog(o)},_openMeasurementDialog:function(e){if(!this._oDialog){this._oDialog=this.getView().byId("measurementDialog")}const t=new s({code:e.code||"",description:e.description||"",ID:e.ID||null,isEdit:!!e.ID});this._oDialog.setModel(t,"local");this._oDialog.open()},onSaveMeasurement:async function(){const e=this._oDialog;const s=e.getModel("local");const n=s.getData();if(!n.code||!n.description){o.error("Code and Description are required.");return}try{const o={code:n.code,description:n.description};const s=n.isEdit?"PUT":"POST";const a=n.isEdit?`./odata/v4/real-estate/Measurements(ID='${n.ID}')`:`./odata/v4/real-estate/Measurements`;const i=await fetch(a,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!i.ok)throw new Error("Failed to save Measurement");t.show("Measurement saved successfully!");e.close();this._loadMeasurements()}catch(e){o.error("Error: "+e.message)}},onCancelMeasurement:function(){this._oDialog.close()},onDeleteMeasurement:function(e){const s=e.getSource().getBindingContext("measurements");const n=s.getObject();o.confirm(`Delete Measurement ${n.code}?`,{onClose:async e=>{if(e==="OK"){try{const e=await fetch(`./odata/v4/real-estate/Measurements(ID='${n.ID}')`,{method:"DELETE"});if(!e.ok)throw new Error("Delete failed");t.show("Deleted successfully");this._loadMeasurements()}catch(e){o.error(e.message)}}}})}})});
//# sourceMappingURL=Measurements.controller.js.map