sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(o,t,e,a){"use strict";return o.extend("dboperations.controller.CalculationMethods",{onInit:function(){this._loadCalculationMethods()},_loadCalculationMethods:function(){fetch("./odata/v4/real-estate/CalculationMethods").then(o=>o.json()).then(o=>{this.getView().setModel(new a(o.value||[]),"calculationMethods")}).catch(o=>console.error("Failed to load CalculationMethods:",o))},onAddCalculationMethod:function(){this._openCalculationMethodDialog({})},onEditCalculationMethod:function(o){const t=o.getSource().getBindingContext("calculationMethods");const e=t.getObject();this._openCalculationMethodDialog(e)},_openCalculationMethodDialog:function(o){if(!this._oDialog){this._oDialog=this.getView().byId("calculationMethodDialog")}const t=new a({code:o.code||"",description:o.description||"",isEdit:!!o.code});this._oDialog.setModel(t,"local");this._oDialog.open()},onSaveCalculationMethod:async function(){const o=this._oDialog;const a=o.getModel("local");const i=a.getData();if(!i.code||!i.description){e.error("Code and Description are required.");return}try{const e=i.isEdit?"PUT":"POST";const a=i.isEdit?`./odata/v4/real-estate/CalculationMethods(code='${i.code}')`:`./odata/v4/real-estate/CalculationMethods`;const n=await fetch(a,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify({code:i.code,description:i.description})});if(!n.ok)throw new Error("Failed to save CalculationMethod");t.show("CalculationMethod saved successfully!");o.close();this._loadCalculationMethods()}catch(o){e.error("Error: "+o.message)}},onCancelCalculationMethod:function(){this._oDialog.close()},onDeleteCalculationMethod:function(o){const a=o.getSource().getBindingContext("calculationMethods");const i=a.getObject();e.confirm(`Delete CalculationMethod ${i.code}?`,{onClose:async o=>{if(o==="OK"){try{const o=await fetch(`./odata/v4/real-estate/CalculationMethods(code='${i.code}')`,{method:"DELETE"});if(!o.ok)throw new Error("Delete failed");t.show("Deleted successfully");this._loadCalculationMethods()}catch(o){e.error(o.message)}}}})}})});
//# sourceMappingURL=CalculationMethods.controller.js.map