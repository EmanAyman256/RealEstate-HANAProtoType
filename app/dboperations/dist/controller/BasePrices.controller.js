sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(e,o,s,t){"use strict";return e.extend("dboperations.controller.BasePrices",{onInit:function(){this._loadBasePrices()},_loadBasePrices:function(){fetch("./odata/v4/real-estate/BasePrices").then(e=>e.json()).then(e=>{this.getView().setModel(new t(e.value||[]),"basePrices")}).catch(e=>console.error("Failed to load BasePrices:",e))},onAddBasePrice:function(){this._openBasePriceDialog({})},onEditBasePrice:function(e){const o=e.getSource().getBindingContext("basePrices");const s=o.getObject();this._openBasePriceDialog(s)},_openBasePriceDialog:function(e){if(!this._oDialog){this._oDialog=this.getView().byId("basePriceDialog")}const o=new t({code:e.code||"",description:e.description||"",isEdit:!!e.code});this._oDialog.setModel(o,"local");this._oDialog.open()},onSaveBasePrice:async function(){const e=this._oDialog;const t=e.getModel("local");const i=t.getData();if(!i.code||!i.description){s.error("Code and Description are required.");return}try{const s=i.isEdit?"PUT":"POST";const t=i.isEdit?`./odata/v4/real-estate/BasePrices(code='${i.code}')`:`./odata/v4/real-estate/BasePrices`;const c=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify({code:i.code,description:i.description})});if(!c.ok)throw new Error("Failed to save BasePrice");o.show("BasePrice saved successfully!");e.close();this._loadBasePrices()}catch(e){s.error("Error: "+e.message)}},onCancelBasePrice:function(){this._oDialog.close()},onDeleteBasePrice:function(e){const t=e.getSource().getBindingContext("basePrices");const i=t.getObject();s.confirm(`Delete BasePrice ${i.code}?`,{onClose:async e=>{if(e==="OK"){try{const e=await fetch(`./odata/v4/real-estate/BasePrices(code='${i.code}')`,{method:"DELETE"});if(!e.ok)throw new Error("Delete failed");o.show("Deleted successfully");this._loadBasePrices()}catch(e){s.error(e.message)}}}})}})});
//# sourceMappingURL=BasePrices.controller.js.map